

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>ARC features: AUX registers and timers &mdash; ARC Labs 2018.09 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/style_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="ARC features: Interrupts" href="lab4.html" />
    <link rel="prev" title="How to use ARC board" href="lab5.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> ARC Labs
          

          
          </a>

          
            
            
              <div class="version">
                2018.09
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction/introduction.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/getting_started.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../labs.html">Hands-on labs</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../level1.html">Basic labs</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="lab1.html">How to use ARC IDE</a></li>
<li class="toctree-l3"><a class="reference internal" href="lab2.html">How to use embARC OSP</a></li>
<li class="toctree-l3"><a class="reference internal" href="lab5.html">How to use ARC board</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">ARC features: AUX registers and timers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#purpose">Purpose</a></li>
<li class="toctree-l4"><a class="reference internal" href="#requirements">Requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="#content">Content</a></li>
<li class="toctree-l4"><a class="reference internal" href="#principles">Principles</a></li>
<li class="toctree-l4"><a class="reference internal" href="#steps">Steps</a></li>
<li class="toctree-l4"><a class="reference internal" href="#exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="lab4.html">ARC features: Interrupts</a></li>
<li class="toctree-l3"><a class="reference internal" href="lab6.html">A simple bootloader</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../level2.html">Advanced labs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../level3.html">Exploration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../appendix/appendix.html">Appendix</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">ARC Labs</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../labs.html">Hands-on labs</a> &raquo;</li>
        
          <li><a href="../level1.html">Basic labs</a> &raquo;</li>
        
      <li>ARC features: AUX registers and timers</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/labs/level1/lab3.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="arc-features-aux-registers-and-timers">
<span id="lab3"></span><h1>ARC features: AUX registers and timers<a class="headerlink" href="#arc-features-aux-registers-and-timers" title="Permalink to this headline">¶</a></h1>
<div class="section" id="purpose">
<h2>Purpose<a class="headerlink" href="#purpose" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>To know the auxiliary registers and processor timers of DesignWare® ARC® processors</li>
<li>To learn how to program auxiliary registers to control the processor timers</li>
</ul>
</div>
<div class="section" id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h2>
<p>The following hardware and tools are required:</p>
<ul class="simple">
<li>PC host</li>
<li>GNU Toolchain for ARC Processors / MetaWare Development Toolkit</li>
<li>ARC board (EM Starter Kit / IoT Development Kit)</li>
<li><code class="docutils literal notranslate"><span class="pre">embarc_osp/arc_labs/labs/lab_timer</span></code></li>
</ul>
</div>
<div class="section" id="content">
<h2>Content<a class="headerlink" href="#content" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Through reading the corresponding BCR (Build Configuration Register) auxiliary registers of processor timers to get the configuration information.</li>
<li>Through programming the auxiliary registers to initialize, start and stop the timer (here TIMER0 is used)</li>
<li>By reading the count value of processor timers, get the execution time of a code block</li>
</ul>
</div>
<div class="section" id="principles">
<h2>Principles<a class="headerlink" href="#principles" title="Permalink to this headline">¶</a></h2>
<div class="section" id="auxiliary-registers">
<h3>Auxiliary Registers<a class="headerlink" href="#auxiliary-registers" title="Permalink to this headline">¶</a></h3>
<p>The auxiliary register set contains status and control registers, which by default are 32 bits wide to implement the processor control, e.g. interrupt and exception management and processor timers. These
auxiliary registers occupy a separate 32-bit address space from the normal memory-access (i.e. load and
store) instructions. Auxiliary registers accessed using distinct Load Register (LR), Store Register (SR), and
Auxiliary EXchange (AEX) instructions.</p>
<p>The auxiliary register address region 0x60 up to 0x7F and region 0xC0 up to 0xFF is reserved for the Build
Configuration Registers (BCRs) that can be used by embedded software or host debug software to detect the
configuration of the ARCv2-based hardware. The Build Configuration Registers contain the version of each
ARCv2-based extension and also the build-specific configuration information.</p>
<p>In embARC OSP,  <code class="docutils literal notranslate"><span class="pre">arc_builtin.h</span></code> provides API (<strong>_arc_aux_read</strong> and <strong>_arc_aux_read</strong>) to access the auxiliary registers</p>
</div>
<div class="section" id="processor-timers">
<h3>Processor Timers<a class="headerlink" href="#processor-timers" title="Permalink to this headline">¶</a></h3>
<p>The processor timers are two independent 32-bit timers and a 64-bit real-time
counter (RTC). <strong>Timer0</strong> and <strong>Timer1</strong> are identical in operation. The only
difference is that these timers are connected to different interrupts. The
Timers cannot be included in a configuration without interrupts. Each timer is
optional and when present, it is connected to a fixed interrupt; interrupt 16
for timer 0 and interrupt 17 for timer 1.</p>
<p>The processor timers are connected to a system clock signal that operates even
when the ARCv2-based processor is in the sleep state. The timers can be used
to generate interrupt signals that wake the processor from the SLEEP state.The
processor timers automatically reset and restart their operation after
reaching the limit value. The processor timers can be programmed to count only
the clock cycles when the processor is not halted. The processor timers can
also be programmed to generate an interrupt or to generate a system Reset upon
reaching the limit value. The 64-bit RTC does not generate any interrupts.
This timer is used to count the clock cycles atomically.</p>
<p>Through the BCR register <em>0x75</em>, you can get the configuration information of processor timers</p>
<p>In embARC OSP, <code class="docutils literal notranslate"><span class="pre">arc_timer.h</span></code> provides API to operate the processor timers.</p>
</div>
<div class="section" id="program-flow-chart">
<h3>Program flow chart<a class="headerlink" href="#program-flow-chart" title="Permalink to this headline">¶</a></h3>
<p>The code’s flow is shown below:</p>
<img alt="program flow chart" src="../../_images/lab3_program_flow_chart.png" />
<p>The code can be divided into 3 parts:</p>
<ul class="simple">
<li>Part1 : read the BCR of internal timers to check the features</li>
<li>Part2 : Promgram Timer0 by auxiliary registers with the embARC OSP provided API</li>
<li>Part3 : read the counts to Timer 0 to measure a code block’s execution time.</li>
</ul>
</div>
</div>
<div class="section" id="steps">
<h2>Steps<a class="headerlink" href="#steps" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>Build and Run</li>
</ol>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> <span class="nb">cd</span> &lt;embarc_root&gt;/arc_labs/labs/lab_timer
<span class="gp">#</span> <span class="k">for</span> emsk
<span class="gp">$</span> make <span class="nv">BOARD</span><span class="o">=</span>emsk <span class="nv">BD_VER</span><span class="o">=</span><span class="m">22</span> <span class="nv">CUR_CORE</span><span class="o">=</span>arcem7d <span class="nv">TOOLCHAIN</span><span class="o">=</span>gnu run
<span class="gp">#</span> <span class="k">for</span> iotdk
<span class="gp">$</span> make <span class="nv">BOARD</span><span class="o">=</span>iotdk <span class="nv">TOOLCHAIN</span><span class="o">=</span>gnu run
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li>Output</li>
</ol>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">-----------------------------------------------------------</span>
<span class="go">      ____                                _ ____</span>
<span class="go">     |  _ \ _____      _____ _ __ ___  __| | __ ) _   _</span>
<span class="go">     | |_) / _ \ \ /\ / / _ \ &#39;__/ _ \/ _` |  _ \| | | |</span>
<span class="go">     |  __/ (_) \ V  V /  __/ | |  __/ (_| | |_) | |_| |</span>
<span class="go">     |_|   \___/ \_/\_/ \___|_|  \___|\__,_|____/ \__, |</span>
<span class="go">                                                  |___/</span>
<span class="go">                          _       _    ____   ____</span>
<span class="go">            ___ _ __ ___ | |__   / \  |  _ \ / ___|</span>
<span class="go">           / _ \ &#39;_ ` _ \| &#39;_ \ / _ \ | |_) | |</span>
<span class="go">          |  __/ | | | | | |_) / ___ \|  _ &lt;| |___</span>
<span class="go">           \___|_| |_| |_|_.__/_/   \_\_| \_\\____|</span>
<span class="go">     ------------------------------------------------------------</span>

<span class="go">     embARC Build Time: Aug 22 2018, 15:32:54</span>
<span class="go">     Compiler Version: MetaWare, 4.2.1 Compatible Clang 4.0.1 (branches/release_40)</span>
<span class="go">     Does this timer0 exist?  YES</span>
<span class="go">     timer0&#39;s operating mode:0x00000003</span>
<span class="go">     timer0&#39;s limit value :0x00023280</span>
<span class="go">     timer0&#39;s current cnt_number:0x0000c236</span>

<span class="go">     Does this timer1 exist?  YES</span>
<span class="go">     timer1&#39;s operating mode:0x00000000</span>
<span class="go">     timer1&#39;s limit value :0x00000000</span>
<span class="go">     timer1&#39;s current cnt_number:0x00000000</span>

<span class="go">     Does this RTC_timer exist?   NO</span>

<span class="go">     The start_cnt number is:2</span>
<span class="go">     /******** TEST MODE START ********/</span>

<span class="go">     This is TEST CODE.</span>

<span class="go">     This is TEST CODE.</span>

<span class="go">     This is TEST CODE.</span>

<span class="go">     /******** TEST MODE END ********/</span>
<span class="go">     The end_cnt number is:16785931</span>
<span class="go">     The board cpu clock is:144000000</span>

<span class="go">     Total time of TEST CODE BLOCK operation:116</span>
</pre></div>
</div>
</div>
<div class="section" id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>Try to program TIMER1</li>
<li>Try to create a clock with a tick of 1 second</li>
</ol>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="lab4.html" class="btn btn-neutral float-right" title="ARC features: Interrupts" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="lab5.html" class="btn btn-neutral" title="How to use ARC board" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Synopsys

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
    

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>